<html>

  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="../CSS/quiz_page.css">
    <link href="https://fonts.googleapis.com/css2?family=Grenze+Gotisch:wght@900&display=swap" rel="stylesheet">
  </head>

  <body background="../IMAGES/download1.jpg" >

    <div id = "outer">
    <div id="logo">
      <img src="../IMAGES/logo.png" id="pic">
      <div class="container-top">
        <p style="color:white; text-align: center; font-size: 70px;">Ruminate</p>
        <img src="../IMAGES/logo2.jpg" id="logo_pic">
      </div>
    </div>
    <br>
    <br>

    <div class="container-mid">

      <div class="container-profile">
        <img
          class="profile-image"
          src="../IMAGES/profile_image.png"
          alt="user"
        />
        <h3>Richard Parker</h3>
        <h6>New York</h6>
        <button id="prof_btn" onclick="location.href='student_profile.html'">Go Back to Profile</button>
      </div>

    <div class="container-cards">
      <button id="button0" class="btn" value="1" onclick="buttonClick(this.id)">Clue 1</button>
      <button id="button1" class="btn" value="1" onclick="buttonClick(this.id)">Clue 2</button>
      <button id="button2" class="btn" value="1" onclick="buttonClick(this.id)">Clue 3</button>
      <button id="button3" class="btn" value="1" onclick="buttonClick(this.id)">Clue 4</button>
      <button id="button4" class="btn" value="1" onclick="buttonClick(this.id)">Clue 5</button>
      <br>
      <button id="button5" class="btn" value="1" onclick="buttonClick(this.id)">Clue 6</button>
      <button id="button6" class="btn" value="1" onclick="buttonClick(this.id)">Clue 7</button>
      <button id="button7" class="btn" value="1" onclick="buttonClick(this.id)">Clue 8</button>
      <button id="button8" class="btn" value="1" onclick="buttonClick(this.id)">Clue 9</button>
      <button id="button9" class="btn" value="1" onclick="buttonClick(this.id)">Clue 10</button>
      <br>
      <button id="button10" class="btn" value="1" onclick="buttonClick(this.id)">Clue 11</button>
      <button id="button11" class="btn" value="1" onclick="buttonClick(this.id)">Clue 12</button>
      <button id="button12" class="btn" value="1" onclick="buttonClick(this.id)">Clue 13</button>
      <button id="button13" class="btn" value="1" onclick="buttonClick(this.id)">Clue 14</button>
      <button id="button14" class="btn" value="1" onclick="buttonClick(this.id)">Clue 15</button>
      <br>
      <button id="button15" class="btn" value="1" onclick="buttonClick(this.id)">Clue 16</button>
      <button id="button16" class="btn" value="1" onclick="buttonClick(this.id)">Clue 17</button>
      <button id="button17" class="btn" value="1" onclick="buttonClick(this.id)">Clue 18</button>
      <button id="button18" class="btn" value="1" onclick="buttonClick(this.id)">Clue 19</button>
      <button id="button19" class="btn" value="1" onclick="buttonClick(this.id)">Clue 20</button>
      <br>
      <button id="button20" class="btn" value="1" onclick="buttonClick(this.id)">Clue 21</button>
      <button id="button21" class="btn" value="1" onclick="buttonClick(this.id)">Clue 22</button>
      <button id="button22" class="btn" value="1" onclick="buttonClick(this.id)">Clue 23</button>
      <button id="button23" class="btn" value="1" onclick="buttonClick(this.id)">Clue 24</button>
      <button id="button24" class="btn" value="1" onclick="buttonClick(this.id)">Clue 25</button>
    </div>

    <div class="container-log">
      Game Log
      <h4 id="log-text"></h4>
    </div>

  </div>
  <br><br>

  <div class="container-bottom">
    <div style="padding-left: 2%;">
      <h1>Score Board</h1>
      <h1 id="score">0</h1>
    </div>
    <h1 id="h1Question"> </h1>
    <h1 id="left"> Tries Left: </h1>
    <button class="next-button" id="next" value="1" onclick="nextQuestion()"> Next Question </button>
  </div>

</div>

    <div id="container-score">
      <h3>Quiz completed!</h3>
      <h3>Your Score for this quiz:</h3>
      <h3 id = "your_score">100</h3>
      <button id = "btn_score" onclick="href:location='student_profile.html'">OK</button>
    </div>




  <script type="text/javascript">
    //Arrays of questions, answers and options.
    //var game = [ [syn, [correct ans length variable], [extra words]], [], [], [], [], [], [], [], [], [],  ] //JSON?
    var game = [ 
               ["Q 1", ["Clue 1", "Clue 2", "Clue 3", "Clue 4", "Clue 5"], ["Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X","Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X"]],
               ["Q 2", ["Clue a", "Clue b", "Clue c", "Clue d", "Clue 1e", "Clue f", "Clue g", "Clue h", "Clue i", "Clue j", "Clue k", "Clue l", "Clue m", "Clue n", "Clue o","Clue p", "Clue q", "Clue r", "Clue s", "Clue t", "Clue u", "Clue v", "Clue w", "Clue x", "Clue y", "Clue z", "clue ab"], ["junk"]],
               ["Q 3", ["Clue 11", "Clue 12", "Clue 13"], [ "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X","Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X"]],
               ["Q 4", ["Clue 16", "Clue 17", "Clue 18", "Clue 19", "Clue 20"], ["Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X","Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X"]],
               ["Q 5", ["Clue 21", "Clue 23", "Clue 24", "Clue 25", "Clue 26"], ["Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X","Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X"]],
               ["Q 6", ["Clue 27", "Clue 28", "Clue 29", "Clue 30", "Clue 31"], ["Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X","Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X"]],
               ["Q 7", ["Clue 32", "Clue 33", "Clue 34", "Clue 35", "Clue 36"], ["Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X","Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X"]],
               ["Q 8", ["Clue 37", "Clue 38", "Clue 39", "Clue 40", "Clue 41"], ["Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X","Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X"]],
               ["Q 9", ["Clue 42", "Clue 43", "Clue 44", "Clue 45", "Clue 46"], ["Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X","Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X"]],
               ["Q 10",["Clue 47", "Clue 48", "Clue 49", "Clue 50", "Clue 51"], ["Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X","Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X", "Clue X"]]
  ];
    var questions = {};                                            //Dict of questions as to be printed
    var answers = {};                                                          //Dictionary with qno:[]
    var ans = new Array();                                                               //list of answers - list of lists
    var extra = new Array();                                                             //List of extra words - list of lists
    for(var i=0; i<10; ++i)
    {
        questions["q" + i] = 'Question ' + (i+1)+ ': ' + game[i][0];
        answers['q' + i] = game[i][1];
        if(game[i][1].length >=25)
        {
            ans[i] = game[i][1].slice(0,25);
            extra[i] = ["1"];                                                   //buffer element/flag
        }
        else
        {
            ans[i] = game[i][1];
            extra[i] = game[i][2];
        } 
    }
    if (extra[0] == "1")
    {
        var cards = ans[0];
    }
    else
    {
        var cards = extra[0].concat(ans[0]);                                    //Array of all cards for a particular question.
    }
    shuffle(cards);                                                             //Shuffle the card list to randomize.
    for(var x=0;x<25;x++)                                                       //Add clue names onto cards
    {
      document.getElementById('button'+ x).innerHTML = '' + cards[x];
    }
    var flag = 0;
    var unlock = 1;                                                             //lock state = 0
    var i = 0;                                                                  //Keep track of question number
    var tries = 0;                                                              //Keep track of attempts
    var max_tries = ans[i].length;  
    var score=0;                                                                //Keep track of scores
    var scoreElement = document.getElementById('score');
    var logText =document.getElementById('log-text');
    ques = document.getElementById("h1Question");                               //Get question
    var str = "q" + i;
    ques.innerHTML = questions[str].toUpperCase();                              //Rewrite question
    var tries_left = document.getElementById("left"); 
    tries_left.innerHTML = "Tries Left : " + max_tries; 
    var max_tries_copy = max_tries;                  

    function buttonClick(clicked_ID)
    {
      var btn = document.getElementById(clicked_ID);
      if(max_tries_copy>0 && btn.value == '1'){
        tries_left.innerHTML = "Tries Left : " + (--max_tries_copy);        
      }
      if ((btn.value == "1") && (unlock == 1))                                                    //Ensure re-click of button isn't counted as a try.
      {
        btn.value = "0"
        var guess = document.getElementById(clicked_ID).innerHTML;              //Extract user answer
        
        if(answers['q' + i].includes(guess) == true)                            //Check user answer
        {
        document.getElementById(clicked_ID).style.background = "url('..//IMAGES/green.jpg') no-repeat top left";      //Mark correct
        score+=4;
        scoreElement.innerHTML = score;
        logText.innerHTML+="Correct Card - 4 points gained";
        logText.innerHTML+="<br /><br />";
        tries++;
        if(tries >= max_tries)                                                          //Next question
        {
          display();
          unlock = 0;                                                                   //Lock the buttons towards further clicking
                                                                           
          setTimeout( () => {                                                 
          unlock = 1;                                                                   //Open the buttons towards clicking.
          if(flag == 0)
          {
            logText.innerHTML = "";
            i++;
            if(i == 10)
            {
                document.getElementById("your_score").innerHTML = score;
                document.getElementById("container-score").style.visibility = 'visible';
                document.getElementById("outer").style.opacity = 0.5;
            }
            if (extra[i] == "1")
            {
                var cards = ans[i];
            }
            else
            {
                var cards = extra[i].concat(ans[i]);                                        //Array of all cards for a particular question.
            }
            shuffle(cards);
            for(var c=0;c<25;c++)                                                           //Replace cards
            {
                document.getElementById('button'+ c).innerHTML = '' + cards[c];
                document.getElementById('button'+ c).style.background = "url('../IMAGES/download.jpg') no-repeat top left";
                document.getElementById('button'+ c).value = "1";
            }
            ques.innerHTML = questions["q" + i].toUpperCase();
            tries = 0;
            max_tries = ans[i].length;
            max_tries_copy = max_tries;
            if (max_tries > 25)
            {
                max_tries = 25;
            }
            return;
            }
            else
            {
                flag = 0;
                return;
            }
          }, 4000);
        }
        }

        else
        {
          document.getElementById(clicked_ID).style.background = "url('../IMAGES/wrong1.jpg') no-repeat top left";
          score-=2;
          scoreElement.innerHTML = score;
          logText.innerHTML+="Wrong Card - 2 points deducted";
          logText.innerHTML+="<br /><br />";
          tries++;
          if(tries >= max_tries)
          {
            display();
            unlock = 0;                                                                     //lock the buttons towards further clicking.
            setTimeout( () => {
            unlock = 1;                                                                     //Open buttons for further clicking.
            if(flag == 0)
            {
                logText.innerHTML = "";
                tries_left.innerHTML = " Tries Left : ";
                i++;
                if(i == 10)
                {
                document.getElementById("your_score").innerHTML = score;
                document.getElementById("container-score").style.visibility = 'visible';
                document.getElementById("outer").style.opacity = 0.5;
                }
                if (extra[i] == "1")
                {
                    var cards = ans[i];
                }
                else
                {
                    var cards = extra[i].concat(ans[i]);                                        //Array of all cards for a particular question.
                }
                shuffle(cards);
                for(var b=0;b<25;b++)
                {
                document.getElementById('button'+ b).innerHTML = '' + cards[b];
                document.getElementById('button'+ b).style.background = "url('../IMAGES/download.jpg') no-repeat top left";
                document.getElementById('button'+ b).value = "1";
                }
                ques.innerHTML = questions["q" + i].toUpperCase();
                tries = 0;
                max_tries = ans[i].length;
                max_tries_copy = max_tries;
                if (max_tries > 25)
                {
                    max_tries = 25;
                }
                return;
            }
            else
            {
              flag = 0;
              return;
            }
            }, 4000);
          }
          else
          {
              return;
          }
      }
    }

}

      function nextQuestion()                                                 //Reset deck to next question
      {
        if(tries == max_tries)
        {
            flag = 1;
        }
        if(i>=9)                                                              //End of game
        {
          ques.innerHTML = "Your Final Score";
          document.getElementById("your_score").innerHTML = score;
          document.getElementById("container-score").style.visibility = 'visible';
          document.getElementById("outer").style.opacity = 0.5;
        }
        else
        {
          i = i+1;
          str = "q" + i;
          ques.innerHTML = questions[str].toUpperCase();
        }
        if (extra[i] == "1")
        {
            var cards = ans[i];
        }
        else
        {
            var cards = extra[i].concat(ans[i]);                                        //Array of all cards for a particular question.
        }
        shuffle(cards)
        for(var c=0;c<25;c++)
        {
          document.getElementById('button'+ c).innerHTML = '' + cards[c];
          document.getElementById('button'+ c).style.background = "url('../IMAGES/download.jpg') no-repeat top left";
          document.getElementById('button'+ c).value = "1";
        }
        logText.innerHTML = "";
        //Ununlock cards for further clicking
        unlock = 1;
        tries = 0;
        max_tries = ans[i].length;
        max_tries_copy = max_tries;
        if (max_tries > 25)
        {
            max_tries = 25;
        }
      }

      function display()                                                      //Display answers
      {
        for (var c=0; c<25; c++)
        {
          var btn = document.getElementById('button'+ c);
          word = btn.innerHTML;
          if (answers['q' + i].includes(word) == true)
          {
            btn.style.background = "url('..//IMAGES/green.jpg') no-repeat top left";
          }
        }
      }

      function shuffle(cards)                                                 //Randomiize cards
      {
        cards.sort(() => Math.random() - 0.5);
      }

    </script>
  </body>
</html>
